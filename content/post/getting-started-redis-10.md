---
title: "redis入门实战之十:Redis的过期策略"
date: 2019-08-12T22:09:48+08:00
draft: false
tags: ["redis"]
categories: "microservice"
toc: true
---
&emsp;redis的过期时间共有三种策略:
### 定时删除
定义: 在设置key的同时，创建一个定时器。当key的过期时间到时，对key进行删除。

优点：保证key能尽快释放。

缺点：若过期key很多，需要创建过多定时器，因此会消耗CPU。在CPU紧张的情况下，不建议采用该种方式。

### 惰性删除

定义：当key过期的时候，并不自动判断删除，而是当每次获取的时候判断是否到期。若过期，则删除，并返回null。该种方式为redis的内置策略。

优点：对CPU占用较少

缺点：由于只有获取的时候才判断是否失效，因此会产生大量垃圾。

### 定期删除

定义：每隔一段时间，执行一次删除过期key操作。

综合：在内存友好方面，不如"定时删除"。在CPU时间友好方面，不如"惰性删除"。

默认：redis.conf配置中
&emsp;hz选项，默认为10 （即1秒执行10次，100ms一次）
&emsp;maxmemory最大值,如果超过最大内存，则触发主动清理。