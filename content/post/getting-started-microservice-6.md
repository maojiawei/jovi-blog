---
title: "微服务架构系列：服务的熔断与限流"
date: 2019-12-11T16:58:16+08:00
draft: false
categories: "microservice"
toc: true
---
&emsp;在了解服务熔断与限流之前，我们先来了解一个重要的概念，叫做: **服务雪崩**。

### 1.0 服务雪崩
&emsp;当我们存在以下这样一个架构，我们有 A、B、C、D、E 五个服务（架构如下图所示）。当服务E不可用之后，C和D的`超时`和`重试`机制将会启动。

&emsp;由于新的调用不断增加，旧的调用没有及时处理，造成了服务C和服务D的调用大量积压，慢慢耗尽服务C和D的资源（例如:CPU或内存），最终导致C和D不可用。

&emsp;同样的情况，A和B也会资源耗尽，最终导致整个系统不可用。

![服务雪崩](../images/microservice/服务雪崩.jpg)



&emsp;一般造成雪崩的原因有以下几点：

1. 程序Bug导致。例如：大量的程序异常会导致运行缓慢甚至宕机。
2. 大量突增请求。例如：大量请求导致资源不可用时。
3. 硬件问题。例如：网络异常，硬件故障灯。
4. 其它



&emsp;有时候服务中断不可避免，但我们可以避免服务雪崩的情况。解决方案如下:

1. 缓存。我们可以利用Redis等中间件缓存数据，避免对下游服务的压力。
2. 降级。
3. 熔断
4. 隔离



### 2.0 服务降级

&emsp;我们

